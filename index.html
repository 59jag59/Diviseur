<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plateau Diviseur 3D</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #f0f0f0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
            overflow: hidden;
        }

        .container {
            display: flex;
            height: 100vh;
            width: 100vw;
        }

        .main-view {
            flex: 1;
            position: relative;
            background: linear-gradient(135deg, #87CEEB, #B0E0E6);
        }
        #plateau-canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        .controls-panel {
            width: 300px;
            background: #fff;
            border-left: 2px solid #ddd;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }
        .panel-header {
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
        }
        .controls-section {
            padding: 20px;
            border-bottom: 1px solid #eee;
        }
        .control-group {
            margin: 15px 0;
        }
        .control-label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
            font-size: 14px;
        }
        .control-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }
        .control-btn {
            padding: 8px 12px;
            border: 2px solid #2196f3;
            background: white;
            color: #2196f3;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: #2196f3;
            color: white;
        }

        .control-btn.active {
            background: #2196f3;
            color: white;
        }

        .control-btn.disabled {
            background: #ccc !important;
            color: #888 !important;
            border-color: #ccc !important;
            cursor: not-allowed !important;
            opacity: 0.5;
        }

        .control-btn.disabled:hover {
            background: #ccc !important;
            color: #888 !important;
        }

        .speed-control {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .speed-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .speed-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2196f3;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .speed-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2196f3;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .speed-slider {
            pointer-events: auto;
        }

        .speed-slider::-webkit-slider-thumb {
            cursor: pointer;
        }

        .speed-slider::-moz-range-thumb {
            cursor: pointer;
        }
        .speed-labels {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 11px;
            color: #666;
        }

        .speed-labels span:nth-child(2) {
            font-weight: bold;
            color: #2196f3;
            font-size: 13px;
        }

        .status-section {
            padding: 20px;
            background: #f8f9fa;
            margin-top: auto;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            font-size: 14px;
        }

        .status-label {
            color: #666;
        }

        .status-value {
            font-weight: bold;
            color: #2196f3;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #000;
            font-size: 20px;
            font-weight: bold;
            z-index: 200;
            background: rgba(255,255,255,0.95);
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #007bff;
        }
        .config-icon {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: #2196f3;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        .config-icon:hover {
            color: #1976d2;
            transform: scale(1.2) rotate(90deg);
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
        }
        .division-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        .division-popup.show {
            display: flex;
        }
        .division-popup-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: popupSlideIn 0.3s ease-out;
        }
        .division-popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }
        .division-popup-title {
            font-size: 24px;
            font-weight: bold;
            color: #2196f3;
            margin: 0;
        }
        .division-input-group {
            margin: 20px 0;
        }
        .division-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
            font-size: 16px;
        }
        .division-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.3s ease;
        }
        .division-input:focus {
            border-color: #2196f3;
            outline: none;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }
        .division-hint {
            display: block;
            color: #666;
            font-size: 13px;
            margin-top: 5px;
            font-style: italic;
        }

        .division-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }

        .division-apply-btn {
            padding: 15px 20px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s ease;
        }

        .division-apply-btn:hover {
            background: #45a049;
        }

        .division-cancel-btn {
            padding: 15px 20px;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s ease;
        }

        .division-cancel-btn:hover {
            background: #da190b;
        }
        .view-icon {
            position: absolute;
            top: 65px;
            left: 15px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            color: #2196f3;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .view-icon:hover {
            color: #1976d2;
            transform: scale(1.2);
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
        }
        .division-icon {
            position: absolute;
            top: 115px;
            left: 15px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            color: #2196f3;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .division-icon:hover {
            color: #1976d2;
            transform: scale(1.2);
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
        }
        .division-info-popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .division-info-popup.show {
            display: flex;
        }

        .division-info-content {
            background: white;
            padding: 25px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .division-info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #2196f3;
            padding-bottom: 10px;
        }

        .division-info-title {
            color: #2196f3;
            font-size: 20px;
            font-weight: bold;
            margin: 0;
        }

        .division-info-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 5px;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .division-info-close:hover {
            background: #f0f0f0;
            color: #333;
        }

        .division-type {
            font-size: 18px;
            font-weight: bold;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .division-type.direct {
            background: #e8f5e8;
            color: #2e7d32;
            border: 2px solid #4caf50;
        }

        .division-type.indirect {
            background: #fff3e0;
            color: #ef6c00;
            border: 2px solid #ff9800;
        }

        .division-details {
            display: grid;
            gap: 15px;
        }

        .detail-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid #2196f3;
        }

        .detail-label {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .detail-value {
            color: #2196f3;
            font-size: 16px;
        }

        .circles-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .circle-item {
            background: #2196f3;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: bold;
        }

        .fraction-display {
            font-family: 'Courier New', monospace;
            background: #f0f0f0;
            padding: 8px;
            border-radius: 4px;
            text-align: center;
            font-size: 18px;
        }

        .popup-ok-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
        }

        .popup-ok-btn:hover {
            background: #45a049;
        }
        .view-icon.active {
            color: #ff9800;
            text-shadow: 0 2px 6px rgba(255, 152, 0, 0.5);
        }

        .config-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .config-popup.show {
            display: flex;
        }

        .config-popup-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: popupSlideIn 0.3s ease-out;
        }

        @keyframes popupSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .config-popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }

        .config-popup-title {
            font-size: 24px;
            font-weight: bold;
            color: #2196f3;
            margin: 0;
        }

        .config-close-btn {
            background: none;
            border: none;
            font-size: 28px;
            color: #999;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .config-close-btn:hover {
            color: #f44336;
            background: rgba(244, 67, 54, 0.1);
        }

        .popup-config-input-group {
            margin: 20px 0;
        }

        .popup-config-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
            font-size: 16px;
        }

        .popup-config-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.3s ease;
        }

        .popup-config-input:focus {
            border-color: #2196f3;
            outline: none;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .popup-config-hint {
            display: block;
            color: #666;
            font-size: 13px;
            margin-top: 5px;
            font-style: italic;
        }

        .popup-config-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }

        .popup-config-apply-btn {
            padding: 15px 20px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s ease;
        }

        .popup-config-apply-btn:hover {
            background: #45a049;
        }

        .popup-config-cancel-btn {
            padding: 15px 20px;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s ease;
        }

        .popup-config-cancel-btn:hover {
            background: #da190b;
        }
        .paypal-
        .paypal-section {
         padding: 15px 20px;
         border-top: 2px solid #eee;
         background: #f9f9f9;
         display: flex;
         justify-content: center;
         margin-bottom: 10vh; 
         }
         .paypal-btn {
            background: #0070ba;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 112, 186, 0.3);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            width: auto;
            justify-content: center;
            border: none;
            min-width: 160px;
            max-width: 200px;

        }

        .paypal-btn:hover {
            background: #005a9e;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 112, 186, 0.4);
        }
        .paypal-form {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
        }
        .rotation-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 30px;
            z-index: 1000;
        }

        .rotation-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: rgba(33, 150, 243, 0.9);
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .rotation-icon:hover {
            color: rgba(33, 150, 243, 1);
            transform: scale(1.2);
            text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.7);
        }

        .rotation-icon:active {
            transform: scale(0.9);
        }

        .rotation-icon.active {
            color: rgba(76, 175, 80, 1);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
        }

        .rotation-icon.active:hover {
            color: rgba(76, 175, 80, 1);
            transform: scale(1.2);
        }
        .circles-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .circle-item {
            background: #2196f3;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            user-select: none;
        }

        .circle-item:hover {
            background: #1976d2;
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .circle-item.selected {
            background: #4CAF50;
            border-color: #2e7d32;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }

        .circle-item.current {
            background: #FF9800;
            border-color: #f57c00;
        }

        .selection-hint {
            margin-top: 10px;
            padding: 8px;
            background: #e3f2fd;
            border-radius: 4px;
            font-size: 12px;
            color: #1976d2;
            text-align: center;
            border: 1px solid #2196f3;
        }

        .current-disk-info {
            background: #fff3e0;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            border-left: 4px solid #ff9800;
        }
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .main-view {
                height: 70vh;
            }

            .controls-panel {
                width: 100%;
                height: 30vh;
                border-left: none;
                border-top: 2px solid #ddd;
            }
        }
    </style>

</head>
<body>
    <div class="container">
        <div class="main-view">
            <canvas id="plateau-canvas"></canvas>

            <div class="loading" id="loading">
                Chargement du plateau diviseur 3D...
            </div>

            <div class="config-icon" onclick="v315()" title="Configuration du plateau">
                ⚙️
            </div>

            <div class="view-icon" onclick="v262()" title="Changer la vue de la caméra" id="view-icon">
                👁️
            </div>

            <div class="division-icon" onclick="v338()" title="Nombre de divisions" id="division-icon">
                📐
            </div>

            <div class="rotation-controls">
                <div class="rotation-icon active" id="counterclockwise-btn" title="Rotation horaire (↻)">
                    ↻
                </div>
                <div class="rotation-icon" id="clockwise-btn" title="Rotation anti-horaire (↺)">
                    ↺
                </div>
            </div>


        </div>

        <div class="controls-panel">
            <div class="panel-header">
                🔧 Plateau Diviseur 3D
            </div>

            <div class="controls-section">
                <h3>⚙️ Commandes rapides</h3>

                <div class="control-group">
                    <div class="control-label">
                        Rotation automatique
                    </div>
                    <div class="control-buttons">
                        <button class="control-btn" id="pause-btn" onclick="v251()">⏸️ Pause</button>
                        <button class="control-btn" id="play-btn" onclick="v251()">▶️ Play</button>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control-label">
                        Position
                    </div>
                    <div class="control-buttons">
                        <button class="control-btn" onclick="v252()">🔄 Reset</button>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control-label">
                        Vitesse
                    </div>
                    <div class="speed-control">
                        <input type="range" id="speed-slider" min="1" max="100" value="1" class="speed-slider">
                        <div class="speed-labels">
                            <span>Lent</span>
                            <span id="speed-value">1</span>
                            <span>Rapide</span>
                        </div>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control-label">
                        Disque (100 pas = 1 tour)
                    </div>
                    <div class="control-buttons">
                        <button class="control-btn" onclick="v279()">↻  1 pas </button>
                        <button class="control-btn" onclick="v280()">↺  -1 pas </button>
                    </div>
                </div>
                <div class="control-group">
                    <div class="control-label">
                        Divisions (360°/N)
                    </div>
                    <div class="control-buttons">
                        <button class="control-btn" id="division-left" onclick="v276(-1)">↻  1 Division</button>
                        <button class="control-btn" id="division-right" onclick="v276(1)">↺  -1 Division</button>
                    </div>
                </div>
                <div class="paypal-section">
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" class="paypal-form">
                        <input type="hidden" name="cmd" value="_donations" />
                    <input type="hidden" name="business" value="59jag59@gmail.com" />
                <input type="hidden" name="currency_code" value="EUR" />
            <input type="hidden" name="item_name" value="Soutien Plateau Diviseur 3D" />
        <input type="hidden" name="no_note" value="1" />
    <input type="hidden" name="no_shipping" value="1" />
<button type="submit" class="paypal-btn" title="Faire un don via PayPal">💳 Don PayPal</button>
</form>
</div>   
<br><br><br>                   
</div>
</div>
</div>

<!-- Popup de configuration -->
<div class="config-popup" id="config-popup">
<div class="config-popup-content">
<div class="config-popup-header">
<h2 class="config-popup-title">⚙️ Configuration du Plateau</h2>
<button class="config-close-btn" onclick="v317()">×</button>
</div>

<div class="popup-config-input-group">
<label for="popup-reduction-input" class="popup-config-label">Rapport de réduction (1:X):</label>
<input type="number" id="popup-reduction-input" value="72" min="1" max="1000" class="popup-config-input">
<small class="popup-config-hint">Ex: 72 = 1 tour disque = 5° plateau</small>
</div>

<div class="popup-config-input-group">
<label for="popup-crans-input" class="popup-config-label">Crans du disque:</label>
<input type="number" id="popup-crans-input" value="100" min="10" max="20000" class="plateaucir">
<small class="popup-config-hint">Ex: 100 = 100 crans pour 1 tour disque</small>
</div>

<div class="popup-config-buttons">
<button class="popup-config-apply-btn" onclick="v318()">✅ Appliquer</button>
<button class="popup-config-cancel-btn" onclick="v317()">❌ Annuler</button>
</div>
</div>
</div>

<!-- Popup de divisions -->
<div id="division-popup" class="division-popup">
<div class="division-popup-content">
<div class="division-popup-header">
<h2 class="division-popup-title">📐 Nombre de Divisions</h2>
<button class="config-close-btn" onclick="v340()">×</button>
</div>

<div class="division-input-group">
<label for="division-number-input" class="division-label">Nombre de divisions :</label>
<input type="number" id="division-number-input" class="division-input" value="12" min="2" max="360">
<span class="division-hint">Entre 2 et 360 divisions (360° ÷ nombre = angle par division)</span>
</div>

<div class="division-buttons">
<button class="division-apply-btn" onclick="v341()">✅ Appliquer</button>
<button class="division-cancel-btn" onclick="v340()">❌ Annuler</button>
</div>
</div>
</div>

<!-- HTML à ajouter après votre popup de divisions existante -->
<div class="division-info-popup" id="division-info-popup">
<div class="division-info-content">
<div class="division-info-header">
<h2 class="division-info-title">📊 Informations Division</h2>
<button class="division-info-close" onclick="v381()">×</button>
</div>

<div class="division-type" id="division-type-display">
<!-- Type de division affiché ici -->
</div>

<div class="division-details">
<div class="detail-item">
<div class="detail-label">
Nombre de divisions :
</div>
<div class="detail-value" id="info-divisions">
12
</div>
</div>

<div class="detail-item">
<div class="detail-label">
Rapport de réduction :
</div>
<div class="detail-value" id="info-reduction">
1:72
</div>
</div>

<div class="detail-item">
<div class="detail-label">
Calcul :
</div>
<div class="detail-value">
<div class="fraction-display" id="info-calculation">
72 ÷ 12 = 6
</div>
</div>
</div>

<div class="detail-item">
<div class="detail-label">
Tours de manivelle :
</div>
<div class="detail-value" id="info-turns">
(5 tours)
</div>
</div>

<div class="detail-item" id="circles-section">
<div class="detail-label">
disques trous utilisables (< 100) :
</div>
<div class="circles-list" id="info-circles">
<!-- Cercles affichés ici -->
</div>
</div>
</div>

<button class="popup-ok-btn" onclick="v381()">✅ Compris !</button>
</div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
let v1, v2, v3, v4;
let v5, v6, v7, v8;
let v9 = false;
let v10 = 0.001;
let v11 =1;
let v12 = 0;
let v13 = 0;
let v14 = 100;
let v15 = 1;
let v16 = 60;
let v17 = 3;
let v18 = 0;
let v19 = 0;

let v20 = 0;
let v21 = false;

let v22 = 'default';
let v23 = {
default: {
v24: 5.335,
v25: 0.563,
v26: 1.467,
v27: {
x: 0,
y: 0,
z: 0
},
v28: {
v29: 3,
v30: 15
}
},
disque: {
v24: 1.5,
v25: 0.3,
v26: 1.57,
v27: {
x: 2,
y: 0.5,
z: 2.4
},
v28: {
v29: 0.8,
v30: 8
}
},
pr: {
v24: 5,
v25: 1.57,
v26: 0,
v27: {
x: 0,
y: 0.8,
z: 0
},
v28: {
v29: 2,
v30: 10
}
}
};

function v31(v32 = {}) {
const v33 = {
v34: 'bottom-right',
v35: 'rgba(33, 150, 243, 0.9)',
v36: 'white',
v37: '12px',
...v32
};

let v38 = '';
switch (v33.v34) {
case 'top-left':
v38 = 'top: 10px; left: 10px;';
break;
case 'bottom-left':
v38 = 'bottom: 10px; left: 10px;';
break;
case 'bottom-right':
v38 = 'bottom: 10px; right: 10px;';
break;
default:
v38 = 'top: 10px; right: 10px;';
}

const v39 = document.createElement('div');
v39.id = 'plateau-display';
v39.style.cssText = `
position: absolute;
${v38}
background: ${v33.v35};
color: ${v33.v36};
padding: 2px;
border-radius: 6px;
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
font-size: ${v33.v37};
z-index: 1000;
pointer-events: none;
min-width: 160px;
border: 2px solid rgba(255, 255, 255, 0.3);
box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
`;

document.querySelector('.main-view').appendChild(v39);
return v39;
}

function v40() {
const v41 = document.getElementById('plateau-display');
if (v41 && v7) {
let v42 = (v7.rotation.y * 180 / Math.PI) % 360;
if (v42 < 0) v42 += 360;

const v43 = v44();
const v45 = v15 === -1 ? 'Horaire ↻': 'Anti-horaire ↺';
const v46 = v15 === -1 ? '#4CAF50': '#FF9800';
const v47 = document.getElementById('info-turns');
const v48 = v47 ? v47.textContent: "Non calculé";
const v49 = v48.match(/(\d+)\s+tours/);
const v50 = v48.match(/(\d+)\/(\d+)/);
const v51 = v49 ? parseInt(v49[1]): 0;
const v52 = v50 ? parseInt(v50[1]): 0;
const v53 = v50 ? parseInt(v50[2]): 1;
const v54 = !v50;
const v55 = v56(v14, v17).v57;
const v58 = (v14/v53)*v52;
v41.innerHTML = `
<strong>Angle:</strong> ${v42.toFixed(2)}° disque ${v14} crans<br>
<strong>Orientation:</strong> <span style="color: ${v46}; font-weight: bold;">${v45}</span><br>
<strong>Nb Div:</strong> ${v17} soit ${v51} tours${v58 > 0 ? ` + ${v58} crans`: ''}<br>
<strong>Angle/div:</strong> ${v43.toFixed(3)}°
`;
}
}

function v59(v60) {
const v61 = document.createElement('canvas');
const v62 = v61.getContext('2d');

const v63 = 512;
const v64 = 128;
v61.width = v63;
v61.height = v64;

const v65 = v62.createLinearGradient(0, 0, 0, v64);
v65.addColorStop(0, '#e8f4fd');
v65.addColorStop(1, '#d4edfc');
v62.fillStyle = v65;
v62.fillRect(0, 0, v63, v64);

v62.strokeStyle = '#2196f3';
v62.lineWidth = 4;
v62.strokeRect(2, 2, v63-4, v64-4);

const v66 = 48;
v62.font = `Bold ${v66}px Arial`;
v62.textAlign = 'center';
v62.textBaseline = 'middle';

v62.fillStyle = '#1976d2';
v62.fillText(v60, v63/2, v64/2);

const v67 = new THREE.CanvasTexture(v61);
v67.needsUpdate = true;
return v67;
}

function v68(v69) {
const v70 = {
v71: {
v72: 'box',
v73: [1,
1,
1]
},
v74: {
color: 0x888888,
shininess: 100,
emissive: 0x000000,
transparent: false,
opacity: 1
},
v80: [0,
0,
0],
v81: [0,
0,
0],
v82: [1,
1,
1],
v83: true,
v84: true,
v85: 'object3D',
v86: null
};

const v87 = {
...v70,
...v69
};
if (v69.v74) v87.v74 = {
...v70.v74,
...v69.v74
};
if (v69.v71) v87.v71 = {
...v70.v71,
...v69.v71
};

let v88;
switch (v87.v71.v72) {
case 'box':
v88 = new THREE.BoxGeometry(...v87.v71.v73);
break;
case 'cylinder':
v88 = new THREE.CylinderGeometry(...v87.v71.v73);
break;
case 'sphere':
v88 = new THREE.SphereGeometry(...v87.v71.v73);
break;
case 'cone':
v88 = new THREE.ConeGeometry(...v87.v71.v73);
break;
case 'torus':
v88 = new THREE.TorusGeometry(...v87.v71.v73);
break;
default:
v88 = new THREE.BoxGeometry(...v87.v71.v73);
}

const v89 = new THREE.MeshPhongMaterial(v87.v74);

const v90 = new THREE.Mesh(v88, v89);
v90.position.set(...v87.v80);
v90.rotation.set(...v87.v81);
v90.scale.set(...v87.v82);
v90.castShadow = v87.v83;
v90.receiveShadow = v87.v84;
v90.name = v87.v85;
if (v87.v86) {
v87.v86.add(v90);
} else {
v1.add(v90);
}
return v90;
}
function v91() {
const v92 = document.createElement('canvas');
const v93 = v92.getContext('2d');
const v94 = 512;
v92.width = v94;
v92.height = v94;
const v95 = v94 / 2;
const v96 = v94 / 2;
const v97 = v94 * 0.49;
v93.fillStyle = '#e3f2fd';
v93.beginPath();
v93.arc(v95, v96, v97, 0, Math.PI * 2);
v93.fill();
for (let v98 = 0; v98 < v14; v98++) {
const v99 = (v98 / v14) * Math.PI * 2 - Math.PI;
let v100 = v14 >= 100 ? 5: Math.max(1, Math.floor(v14 / 20));
if (v14 <= 40) {
v100 = 1;
v98 = v98+1;
} else if (v14 <= 80) {
v100 = 2;
v98 = v98 + 1;
} else if (v14 <= 100) {
v100 = 5;
v98 = v98 + 0;
} else if (v14 <= 300) {
v100 = 10;
v98 = v98 + 4;
}
const v101 = (v98 % v100 === 0);
const v102 = v101 ? 3: 1;
const v103 = v97 * (v101 ? 0.85: 0.90);
const v104 = v97 * 0.98;
const v105 = v95 + Math.cos(v99) * v103;
const v106 = v96 + Math.sin(v99) * v103;
const v107 = v95 + Math.cos(v99) * v104;
const v108 = v96 + Math.sin(v99) * v104;
v93.strokeStyle = '#000000';
v93.lineWidth = v102;
v93.beginPath();
v93.moveTo(v105, v106);
v93.lineTo(v107, v108);
v93.stroke();
}

let v109 = [];
if (v14 <= 40) {
for (let v98 = 0; v98 < v14; v98++) {
v109.push(v98);
}
} else if (v14 <= 80) {
for (let v98 = 0; v98 < v14; v98 += 2) {
v109.push(v98);
}
} else if (v14 <= 100) {
for (let v98 = 0; v98 < v14; v98 += 5) {
v109.push(v98);
}
} else if (v14 <= 300) {
for (let v98 = 0; v98 < v14; v98 += 10) {
v109.push(v98);
}
} else if (v14 <= 1000) {
for (let v98 = 0; v98 < v14; v98 += 25) {
v109.push(v98);
}
} else if (v14 <= 10000) {
for (let v98 = 0; v98 < v14; v98 += 250) {
v109.push(v98);
}
} else {
for (let v98 = 0; v98 < v14; v98 += 1000) {
v109.push(v98);
}
}
v109.forEach(v110 => {
const v111 = (v110 / v14) * Math.PI * 2 - Math.PI;
const v112 = v97 * 0.82;
const v113 = v95 + Math.cos(v111) * v112;
const v114 = v96 + Math.sin(v111) * v112;

const v115 = v14 <= 50 ? 18: v14 <= 200 ? 16: 14;
const v116 = v110 === 0 ? '#cc0000': '#000000';

v93.save();

v93.translate(v113, v114);

v93.rotate(v111 + Math.PI / 2);

v93.font = `Bold ${v115}px Arial`;
v93.textAlign = 'center';
v93.textBaseline = 'middle';

const v117 = v110.toString();
const v118 = v93.measureText(v117).width;
const v119 = v118 + 8;
const v120 = v115 + 4;
v93.fillStyle = 'rgba(255, 255, 255, 0.9)';
v93.fillRect(-v119/2, -v120/2, v119, v120);

v93.strokeStyle = '#ffffff';
v93.lineWidth = 2;
v93.strokeText(v117, 0, 0);

v93.fillStyle = v116;
v93.fillText(v117, 0, 0);

v93.restore();
});

const v121 = v97 * 0.15;
v93.fillStyle = '#404040';
v93.beginPath();
v93.arc(v95, v96, v121, 0, Math.PI * 2);
v93.fill();

v93.strokeStyle = '#202020';
v93.lineWidth = 2;
v93.stroke();

const v122 = new THREE.CanvasTexture(v92);
v122.needsUpdate = true;
return v122;
}

function v123() {
const v124 = document.createElement('canvas');
const v125 = v124.getContext('2d');

const v126 = 1024;
v124.width = v126;
v124.height = v126;

const v127 = v126 / 2;
const v128 = v126 / 2;
const v129 = v126 * 0.5;

v125.fillStyle = '#f0f0f0';
v125.beginPath();
v125.arc(v127, v128, v129, 0, Math.PI * 2);
v125.fill();

for (let v98 = 0; v98 < 36; v98++) {
const v130 = (v98 / 36) * Math.PI * 2 - Math.PI / 2;
const v131 = v98 * 10;

const v132 = v129 * 0.95;
const v133 = v127 + Math.cos(v130) * v132;
const v134 = v128 + Math.sin(v130) * v132;

const v135 = (v98 % 6 === 0);
const v136 = v135 ? 36: 28;
const v137 = v135 ? '#cc0000': '#000000';

v125.save();

v125.translate(v133, v134);

v125.rotate(v130 + Math.PI / 2 + Math.PI);

v125.font = `Bold ${v136}px Arial`;
v125.textAlign = 'center';
v125.textBaseline = 'middle';

const v138 = v135 ? 55: 45;
const v139 = v135 ? 30: 25;
v125.fillStyle = 'rgba(255, 255, 255, 0.95)';
v125.fillRect(-v138/2, -v139/2, v138, v139);

v125.strokeStyle = '#ffffff';
v125.lineWidth = v135 ? 6: 4;
v125.strokeText(v131 + '°', 0, 0);

v125.fillStyle = v137;
v125.fillText(v131 + '°', 0, 0);

v125.restore();
}

const v140 = [1.0,
1.5,
2.0];
for (let v141 of v140) {
const v142 = (v141 / 2.5) * v129;

v125.strokeStyle = '#404040';
v125.lineWidth = 4;
v125.beginPath();
v125.arc(v127, v128, v142, 0, Math.PI * 2);
v125.stroke();
}

for (let v98 = 0; v98 < 6; v98++) {
const v143 = (v98 / 6) * Math.PI * 2;

const v144 = 1.5;
const v145 = 1.25;

const v146 = (v145 / 2.5) * v129;
const v147 = (v144 / 2.5) * v129;

const v148 = v146 - v147/2;
const v149 = v146 + v147/2;

const v150 = v127 + Math.cos(v143) * v148;
const v151 = v128 + Math.sin(v143) * v148;
const v152 = v127 + Math.cos(v143) * v149;
const v153 = v128 + Math.sin(v143) * v149;

v125.strokeStyle = '#404040';
v125.lineWidth = 30;
v125.lineCap = 'round';
v125.beginPath();
v125.moveTo(v150, v151);
v125.lineTo(v152, v153);
v125.stroke();
}

for (let v98 = 0; v98 < 360; v98++) {
const v154 = (v98 / 360) * Math.PI * 2;

const v155 = 2.5;
const v156 = (v155 / 2.5) * v129;

let v157 = 28;
let v158 = 5;

if (v98 % 5 !== 0) {
v157 = 15;
v158 = 2;
}
const v159 = v127 + Math.cos(v154) * (v156 - v157/2);
const v160 = v128 + Math.sin(v154) * (v156 - v157/2);
const v161 = v127 + Math.cos(v154) * (v156 + v157/2);
const v162 = v128 + Math.sin(v154) * (v156 + v157/2);

v125.strokeStyle = '#000000';
v125.lineWidth = v158;
v125.lineCap = 'round';
v125.beginPath();
v125.moveTo(v159, v160);
v125.lineTo(v161, v162);
v125.stroke();
}

const v163 = new THREE.CanvasTexture(v124);
v163.needsUpdate = true;
return v163;
}

function v164() {
v1 = new THREE.Scene();
v1.background = new THREE.Color(0x87CEEB);

const v165 = document.getElementById('plateau-canvas');
v2 = new THREE.PerspectiveCamera(75, v165.clientWidth / v165.clientHeight, 0.1, 1000);
v2.position.set(5, 4, 5);

v3 = new THREE.WebGLRenderer({
canvas: v165,
antialias: true
});
v3.setSize(v165.clientWidth, v165.clientHeight);
v3.shadowMap.enabled = true;
v3.shadowMap.type = THREE.PCFSoftShadowMap;
v3.physicallyCorrectLights = true;

v166();

v167();

v168();

v31( {
v34: 'top-right',
v35: 'rgba(33, 150, 243, 0.85)',
v36: 'white',
v37: '12px'
});
v390();  
    v392();
    v394();
    function v400() {
        const v354 = v348(v17, v16);
        document.getElementById('info-divisions').textContent = v17;
        document.getElementById('info-reduction').textContent = `1:${v16}`;
        
        const v370 = document.getElementById('info-calculation');
        if (v354.v355) {
            v370.textContent = `${v16} ÷ ${v17} = ${v354.v351}`;
        } else {
            v370.innerHTML = `${v16} ÷ ${v17} = ${v354.v352} + <sup>${v354.v356.v364}</sup>⁄<sub>${v354.v356.v365}</sub>`;
        }
        const v371 = document.getElementById('info-turns');
        if (v354.v355) {
            v371.textContent = `(${v354.v351} tours )`;
        } else {
            v371.textContent = `(${v354.v352} tours + ${v354.v356.v364}/${v354.v356.v365} crans)`;
        }
        document.getElementById('popup-reduction-input').value = v16;
        document.getElementById('popup-crans-input').value = v14;
        document.getElementById('division-number-input').value = v17;
    }
    v400(); 
v169();
v170();
v171();
v172();
v173()

document.getElementById('loading').style.display = 'none';
}

function v167() {
const v174 = new THREE.AmbientLight(0x404040, 0.6);
v1.add(v174);

const v175 = new THREE.DirectionalLight(0xffffff, 1.2);
v175.position.set(0, 5, 10);
v175.castShadow = true;
v175.shadow.mapSize.width = 2048;
v175.shadow.mapSize.height = 2048;
v1.add(v175);

const v176 = new THREE.SpotLight(0x2196f3, 0.4);
v176.position.set(-5, 8, 3);
v176.angle = Math.PI / 6;
v1.add(v176);

const v177 = new THREE.DirectionalLight(0xffffff, 0.3);
v177.position.set(-5, -5, -5);
v1.add(v177);

const v178 = new THREE.DirectionalLight(0xffffff, 0.1);
v178.position.set(10, 15, 0);
v1.add(v178);

const v179 = new THREE.DirectionalLight(0xffffff, 0.4);
v179.position.set(0, 0, 10);
v1.add(v179);

window.mainLight = v175;
}

function v168() {
v5 = new THREE.Group();

v180();

v181();

v1.add(v5);

}

function v180() {
const v182 = v59(atob("NTlqYWc="));
const v183 = [
new THREE.MeshPhongMaterial({
color: 0xe3f2fd, shininess: 150, emissive: 0x001100
}),
new THREE.MeshPhongMaterial({
color: 0xe3f2fd, shininess: 150, emissive: 0x001100
}),
new THREE.MeshPhongMaterial({
color: 0xe3f2fd, shininess: 150, emissive: 0x001100
}),
new THREE.MeshPhongMaterial({
color: 0xe3f2fd, shininess: 150, emissive: 0x001100
}),
new THREE.MeshPhongMaterial({
color: 0xe3f2fd,
shininess: 150,
emissive: 0x001100,
map: v182
}),
new THREE.MeshPhongMaterial({
color: 0xe3f2fd, shininess: 150, emissive: 0x001100
}),
];

const v184 = new THREE.BoxGeometry(6, 1, 2.5);
const v185 = new THREE.Mesh(v184, v183);
v185.position.set(0, 0, 0);
v185.castShadow = true;
v185.receiveShadow = true;
v185.name = 'box1';
v1.add(v185);

v68( {
v71: {
v72: 'box', v73: [0.01, 0.1, 0.15]
},
v74: {
color: 0x000000,
shininess: 150,
emissive: 0x001100
},
v80: [2, 0.8, 2.39],
v85: 'traitdisque'
});
v68( {
v71: {
v72: 'cylinder', v73: [0.8, 0.8, 0.08, 64]
},
v74: {
color: 0xe3f2fd,
shininess: 150,
emissive: 0x001100
},
v80: [2, 0, 2.35],
v81: [Math.PI/2, 0, 0],
v85: 'contrecardan'
});
v8 = new THREE.Group();
v8.position.set(2, 0, 2.4);

const v186 = v91();
const v187 = new THREE.CylinderGeometry(0.6, 0.6, 0.1, 100);
const v188 = new THREE.MeshPhongMaterial({
color: 0xe3f2fd,
shininess: 150,
emissive: 0x001100,
map: v186
});
const v189 = new THREE.Mesh(v187, v188);
v189.position.set(0, 0, 0);
v189.rotation.set(Math.PI/2, 0, 0);
v189.scale.set(1.3, 1.3, 1.3);
v189.castShadow = true;
v189.receiveShadow = true;
v189.name = 'disque';
v8.add(v189);

const v190 = new THREE.CylinderGeometry(0.1, 0.1, 0.8, 10);
const v191 = new THREE.MeshPhongMaterial({
color: 0xe3f2fd,
shininess: 150,
emissive: 0x001100
});
const v192 = new THREE.Mesh(v190, v191);
v192.position.set(0.4, 0, 0.6);
v192.rotation.set(Math.PI/2, 0, 0);
v192.scale.set(1.3, 1.3, 1.2);
v192.castShadow = true;
v192.receiveShadow = true;
v192.name = 'manivelle';
v8.add(v192);

v1.add(v8);

v68( {
v71: {
v72: 'box', v73: [0.8, 0.8, 1.8]
},
v74: {
color: 0xe3f2fd,
shininess: 150,
emissive: 0x001100
},
v80: [2, 0, 1.5],
v85: 'box2'
});
v68( {
v71: {
v72: 'cylinder', v73: [2.6, 2.6, 0.6, 64]
},
v74: {
color: 0xe3f2fd,
shininess: 150,
emissive: 0x001100
},
v80: [0, 0.6, 0],
v85: 'cyl2'
});

const v193 = 2.59;
const v194 = 0.62;
const v195 = 0.02;
const v196 = 0.3;

const v197 = [0,
90,
180,
270];

v197.forEach(v198 => {
const v199 = (v198 * Math.PI) / 180;

const v200 = Math.cos(v199) * (v193 - v196/2);
const v201 = Math.sin(v199) * (v193 - v196/2);

v68( {
v71: {
v72: 'box', v73: [v196, v194, v195]
},
v74: {
color: 0x000000,
shininess: 50
},
v80: [v200, 0.6, v201],
v81: [0, v199, 0],
v85: `graduation_${v198}`
});
});
}

function v181() {
v7 = new THREE.Group();

const v202 = v123();

const v203 = new THREE.CylinderGeometry(2.5, 2.5, 0.3, 64);
const v204 = new THREE.MeshPhongMaterial({
color: 0xf0f0f0,
shininess: 150,
specular: 0x666666,
emissive: 0x303030,
map: v202
});
const v205 = new THREE.Mesh(v203, v204);
v205.position.y = 0.8;
v205.castShadow = true;
v205.receiveShadow = true;
v7.add(v205);

const v206 = new THREE.CylinderGeometry(0.3, 0.3, 0.31, 32);
const v207 = new THREE.MeshPhongMaterial({
color: 0xf5f5f5,
shininess: 120,
emissive: 0x050505
});
const v208 = new THREE.Mesh(v206, v207);
v208.position.y = 0.8;
v7.add(v208);

const v209 = new THREE.CylinderGeometry(0.18, 0.18, 0.32, 16);
const v210 = new THREE.MeshPhongMaterial({
color: 0x444444,
emissive: 0x000000
});
const v211 = new THREE.Mesh(v209, v210);
v211.position.y = 0.8;
v7.add(v211);

v212();

v213 = v214();

v5.add(v7);
}

function v212() {
const v215 = 2.47;
const v216 = 0.8 + 0.15;
const v217 = 0.4;
const v218 = 0.08;

const v219 = new THREE.MeshPhongMaterial({
color: 0x00ff00,
transparent: true,
opacity: 0.6,
shininess: 100
});

for (let v98 = 0; v98 < v17; v98++) {
const v220 = (v98 / v17) * Math.PI * 2;

const v221 = Math.cos(v220) * v215;
const v222 = Math.sin(v220) * v215;

const v223 = new THREE.ConeGeometry(v218, v217, 8);
const v224 = new THREE.Mesh(v223, v219);

v224.position.set(v221, v216 + v217/2, v222);

v224.rotation.x = Math.PI;

v224.castShadow = false;
v224.receiveShadow = true;
v224.name = `division_cone_${v98}`;

v7.add(v224);
}
}

function v214() {
const v225 = 2.47;
const v226 = 0.8 + 0.15;
const v227 = 0.5;
const v228 = 0.1;

const v229 = new THREE.MeshPhongMaterial({
color: 0xff0000,
transparent: true,
opacity: 0.8,
shininess: 100,
emissive: 0x440000
});

const v230 = new THREE.ConeGeometry(v228, v227, 8);
const v231 = new THREE.Mesh(v230, v229);

v231.position.set(v225, v226 + v227/2, 0);

v231.rotation.x = Math.PI;

v231.castShadow = false;
v231.receiveShadow = true;
v231.name = 'current_angle_cone';

v1.add(v231);

return v231;
}

let v213 = null;

function v166() {
let v232 = false;
let v233 = 0,
v234 = 0;

window.cameraDistance = v23.default.v24;
window.cameraAngleX = v23.default.v25;
window.cameraAngleY = v23.default.v26;
window.cameraTarget = v23.default.v27;

function v235() {
const v236 = window.cameraTarget;
v2.position.x = v236.x + Math.cos(window.cameraAngleY) * Math.cos(window.cameraAngleX) * window.cameraDistance;
v2.position.y = v236.y + Math.sin(window.cameraAngleX) * window.cameraDistance;
v2.position.z = v236.z + Math.sin(window.cameraAngleY) * Math.cos(window.cameraAngleX) * window.cameraDistance;
v2.lookAt(v236.x, v236.y, v236.z);
}

window.updateCamera = v235;

const v237 = v3.domElement;

v237.addEventListener('mousedown', (v238) => {
v232 = true;
v233 = v238.clientX;
v234 = v238.clientY;
v237.style.cursor = 'grabbing';
v238.preventDefault();
});

document.addEventListener('mousemove', (v238) => {
if (v232) {
const v239 = v238.clientX - v233;
const v240 = v238.clientY - v234;

window.cameraAngleY += v239 * 0.01;
window.cameraAngleX += v240 * 0.01;
window.cameraAngleX = Math.max(-Math.PI/2 + 0.1, Math.min(Math.PI/2 - 0.1, window.cameraAngleX));

v235();

v233 = v238.clientX;
v234 = v238.clientY;
}
});

document.addEventListener('mouseup',
() => {
if (v232) {
v232 = false;
v237.style.cursor = 'grab';
}
});

v237.addEventListener('wheel',
(v238) => {
const v241 = v23[v22].v28;
window.cameraDistance += v238.deltaY * 0.01;
window.cameraDistance = Math.max(v241.v29, Math.min(v241.v30, window.cameraDistance));
v235();
v238.preventDefault();
});

let v242, v243;
let v244 = 0;

v237.addEventListener('touchstart',
(v238) => {
if (v238.touches.length === 1) {
const v245 = v238.touches[0];
v242 = v245.clientX;
v243 = v245.clientY;
} else if (v238.touches.length === 2) {
const v246 = v238.touches[0];
const v247 = v238.touches[1];
v244 = Math.sqrt(
Math.pow(v247.clientX - v246.clientX, 2) +
Math.pow(v247.clientY - v246.clientY, 2)
);
}
v238.preventDefault();
});

v237.addEventListener('touchmove',
(v238) => {
if (v238.touches.length === 1) {
const v245 = v238.touches[0];
const v239 = v245.clientX - v242;
const v240 = v245.clientY - v243;

window.cameraAngleY += v239 * 0.01;
window.cameraAngleX += v240 * 0.01;
window.cameraAngleX = Math.max(-Math.PI/2 + 0.1, Math.min(Math.PI/2 - 0.1, window.cameraAngleX));

v235();

v242 = v245.clientX;
v243 = v245.clientY;
} else if (v238.touches.length === 2) {
const v246 = v238.touches[0];
const v247 = v238.touches[1];
const v248 = Math.sqrt(
Math.pow(v247.clientX - v246.clientX, 2) +
Math.pow(v247.clientY - v246.clientY, 2)
);

if (v244 > 0) {
const v249 = v248 - v244;
const v241 = v23[v22].v28;
window.cameraDistance -= v249 * 0.02;
window.cameraDistance = Math.max(v241.v29, Math.min(v241.v30, window.cameraDistance));
v235();
}

v244 = v248;
}
v238.preventDefault();
});

v237.addEventListener('touchend',
(v238) => {
if (v238.touches.length === 0) {
v244 = 0;
}
v238.preventDefault();
});

v237.style.cursor = 'grab';

v235();

v250();
}

function v250() {
document.addEventListener('keydown',
(v238) => {
switch (v238.code) {
case 'Space':
v238.preventDefault();
v251();
break;
case 'KeyR':
v238.preventDefault();
v252();
break;
case 'KeyA':
v238.preventDefault();
v253();
break;
case 'ArrowLeft':
v238.preventDefault();
const v254 = Math.round(0.1 * v16 * v14 / (Math.PI * 2));
v19 -= v254;
v255();
v9 = false;
v21 = false;
v13 = 0;
v171();
v169();
break;
case 'ArrowRight':
v238.preventDefault();
const v256 = Math.round(0.1 * v16 * v14 / (Math.PI * 2));
v19 += v256;
v255();
v9 = false;
v21 = false;
v13 = 0;
v171();
v169();
break;
case 'ArrowUp':
v238.preventDefault();
const v257 = document.getElementById('speed-slider');
const v258 = Math.min(parseInt(v257.value) + 5, 100);
v257.value = v258;
v259();
break;
case 'ArrowDown':
v238.preventDefault();
const v260 = document.getElementById('speed-slider');
const v261 = Math.max(parseInt(v260.value) - 5, 1);
v260.value = v261;
v259();
break;
case 'KeyQ':
v238.preventDefault();
v19 -= 1;
v255();
v9 = false;
v21 = false;
v13 = 0;
v171();
v169();
break;
case 'KeyE':
v238.preventDefault();
v19 += 1;
v255();
v9 = false;
v21 = false;
v13 = 0;
v171();
v169();
break;
case 'KeyV':
v238.preventDefault();
v262();
break;
}
});
}

function v255() {
if (!v21) {
const v263 = 360 / v17;
const v264 = v18 * v263;
const v265 = (v264 * Math.PI) / 180;

const v266 = Math.round(v265 * v16 * v14 / (Math.PI * 2));
v12 = v266 + v19;
}

const v267 = v12 * (Math.PI * 2) / v14;
v8.rotation.z = v267;

const v268 = v12 * (Math.PI * 2) / (v14 * v16);
v7.rotation.y = v268;
}

function v269(v270) {
const v271 = v270 * v15;

const v263 = 360 / v17;

const v272 = v18 + v271;

const v273 = v272 * v263;
const v274 = (v273 * Math.PI) / 180;

const v275 = Math.round(v274 * v16 * v14 / (Math.PI * 2));
v20 = v275 + v19;

v21 = true;
v9 = false;
v13 = 0;
v171();
}

function v276(v270) {
if (!v21) {
v269(v270);
}
}

function v171() {
const v277 = document.getElementById('division-left');
const v278 = document.getElementById('division-right');

if (v21) {
v277.classList.add('disabled');
v278.classList.add('disabled');
v277.disabled = true;
v278.disabled = true;
} else {
v277.classList.remove('disabled');
v278.classList.remove('disabled');
v277.disabled = false;
v278.disabled = false;
}
}

function v44() {
return 360 / v17;
}

function v279() {
const v271 = -1 * v15;
v19 += v271;
v255();
v9 = false;
v21 = false;
v13 = 0;
v171();
v169();
}

function v280() {
const v271 = 1 * v15;
v19 += v271;
v255();
v9 = false;
v21 = false;
v13 = 0;
v171();
v169();
}


function v281() {
const v282 = (v7.rotation.y * 180 / Math.PI) % 360;
const v263 = 360 / v17;
const v283 = Math.round(v282 / v263);

const v284 = (v283 * v263 * Math.PI) / 180;
const v285 = Math.round(v284 * v16 * v14 / (Math.PI * 2));

v18 = v283;
v19 = v12 - v285;
}

function v172() {
requestAnimationFrame(v172);

if (v21) {
const v286 = v10 * v16;
const v287 = v286 / ((Math.PI * 2) / v14);

v13 += v287;

const v288 = v20 > v12 ? 1: -1;

if (Math.abs(v13) >= 1) {
let v289 = Math.floor(Math.abs(v13)) * v288;

const v290 = Math.abs(v20 - v12);
if (Math.abs(v289) >= v290) {
v12 = v20;
v21 = false;
v13 = 0;

const v291 = (v7.rotation.y * 180 / Math.PI) % 360;
const v263 = 360 / v17;
v18 = Math.round(v291 / v263);

const v292 = (v18 * v263 * Math.PI) / 180;
const v293 = Math.round(v292 * v16 * v14 / (Math.PI * 2));
v19 = v12 - v293;

v171();
} else {
v12 += v289;
v13 -= Math.abs(v289);
}

v255();
}
} else if (v9 && v10 > 0) {
const v294 = v10 * v16 * v15;
const v295 = v294 / ((Math.PI * 2) / v14);

v13 += v295;

if (Math.abs(v13) >= 1) {
const v296 = Math.floor(v13);
v19 += v296;
v13 -= v296;
v255();
}
}

v297();

v40();

v3.render(v1, v2);
}

function v251() {
v9 = !v9;
if (v9) {
v21 = false;
v171();
} else {
v13 = 0;
}
v169();
}

function v252() {
v18 = 0;
v19 = 0;
v21 = false;
v13 = 0;
v255();
v171();
v169();
}

function v259() {
const v298 = document.getElementById('speed-slider');
v11 = parseInt(v298.value);

const v299 = 0.00001;
const v300 = 0.2;

const v301 = v11 / 100;
const v302 = Math.pow(v11 / 100, 1.5);
v10 = v299 + (v301 * 0.3 + v302 * 0.7) * (v300 - v299);

document.getElementById('speed-value').textContent = v11;
v169();
}


function v170() {
const v298 = document.getElementById('speed-slider');
let v303 = false;

function v304(v305) {
const v306 = v298.getBoundingClientRect();
const v307 = (v305 - v306.left) / v306.width;
const v308 = (v298.value - v298.min) / (v298.max - v298.min);

return Math.abs(v307 - v308) <= 0.1;
}

v298.addEventListener('touchstart', (v309) => {
const v310 = v309.touches[0];
if (v304(v310.clientX)) {
v303 = true;
} else {
v303 = false;
v309.preventDefault();
}
});

v298.addEventListener('touchend',
() => {
v303 = false;
});

v298.addEventListener('mousedown',
(v309) => {
if (v304(v309.clientX)) {
v303 = true;
} else {
v303 = false;
v309.preventDefault();
}
});

v298.addEventListener('mouseup',
() => {
v303 = false;
});

v298.addEventListener('input',
() => {
if (v303) {
v259();
}
});

v259();
}

function v262() {
const v311 = document.getElementById('view-icon');

if (v22 === 'default') {
v22 = 'disque';
v311.classList.add('active');
v311.title = "Vue disque active - Cliquer pour vue plateau";
} else if (v22 === 'disque') {
v22 = 'pr';
v311.classList.add('active');
v311.title = "Vue plateau active - Cliquer pour vue générale";
} else {
v22 = 'default';
v311.classList.remove('active');
v311.title = "Vue générale active - Cliquer pour voir le disque";
}

v312();
}

function v312() {
const v313 = v23[v22];

window.cameraDistance = v313.v24;
window.cameraAngleX = v313.v25;
window.cameraAngleY = v313.v26;
window.cameraTarget = v313.v27;

const v314 = v313.v28;
window.cameraDistance = Math.max(v314.v29, Math.min(v314.v30, window.cameraDistance));

window.updateCamera();
}

function v315() {
const v316 = document.getElementById('config-popup');
document.getElementById('popup-reduction-input').value = v16;
document.getElementById('popup-crans-input').value = v14;

v316.classList.add('show');
}

function v317() {
const v316 = document.getElementById('config-popup');
v316.classList.remove('show');
}

function v318() {
const v319 = parseInt(document.getElementById('popup-reduction-input').value);
const v320 = parseInt(document.getElementById('popup-crans-input').value);

if (v319 >= 1 && v319 <= 1000 &&
v320 >= 10 && v320 <= 20000) {

const v321 = v7.rotation.y;

v16 = v319;
v14 = v320;

v12 = Math.round(v321 * v16 * v14 / (Math.PI * 2));

const v322 = (v321 * 180 / Math.PI) % 360;
const v323 = 360 / v17;
const v324 = Math.round(v322 / v323);
const v325 = (v324 * v323 * Math.PI) / 180;
const v326 = Math.round(v325 * v16 * v14 / (Math.PI * 2));
v18 = v324;
v19 = v12 - v326;
v327();
v328();
v329();
v213 = v214();
const v354 = v348(v17, v16); 
       document.getElementById('info-divisions').textContent = v17;
        document.getElementById('info-reduction').textContent = `1:${v16}`;
        const v370 = document.getElementById('info-calculation');
        if (v354.v355) {
            v370.textContent = `${v16} ÷ ${v17} = ${v354.v351}`;
        } else {
            v370.innerHTML = `${v16} ÷ ${v17} = ${v354.v352} + <sup>${v354.v356.v364}</sup>⁄<sub>${v354.v356.v365}</sub>`;
        }
        
        const v371 = document.getElementById('info-turns');
        if (v354.v355) {
            v371.textContent = `(${v354.v351} tours )`;
        } else {
            v371.textContent = `(${v354.v352} tours + ${v354.v356.v364}/${v354.v356.v365} crans)`;
        }
v255();
v171();
v169();
v40();
v392();
v317();
} else {
alert('Valeurs invalides !\nRapport: 1-1000\nDivisions: 2-360\nCrans: 10-1000');
}
}

document.addEventListener('click', function(v330) {
const v316 = document.getElementById('config-popup');
const v331 = document.querySelector('.config-popup-content');
const v332 = document.querySelector('.config-icon');

if (v316 && v316.classList.contains('show') &&
!v331.contains(v330.target) &&
!v332.contains(v330.target)) {
v317();
}
});

document.addEventListener('keydown', function(v330) {
if (v330.key === 'Escape') {
const v316 = document.getElementById('config-popup');
if (v316 && v316.classList.contains('show')) {
v317();
}
}
});

function v329() {
if (v213) {
v1.remove(v213);
v213.geometry.dispose();
v213.material.dispose();
v213 = null;
}
}

function v328() {
const v333 = [];
v7.children.forEach(v334 => {
if (v334.name && v334.name.startsWith('division_cone_')) {
v333.push(v334);
}
});
v333.forEach(v335 => {
v7.remove(v335);
v335.geometry.dispose();
v335.material.dispose();
});

v212();
}

function v327() {
    const v336 = v91();

    v8.children.forEach(v334 => {
        if (v334.name === 'disque') {  // ← Condition spécifique au disque
            v334.material.map = v336;
            v334.material.needsUpdate = true;
        }
    });
}
function v337() {
switch (v22) {
case 'disque':
return 'disque';
case 'pr':
return 'Plateau';
default:
return 'Générale';
}
}
function v169() {}
function v297() {
if (v7) {
let v42 = (v7.rotation.y * 180 / Math.PI) % 360;
if (v42 < 0) v42 += 360;
}
}
function v338() {
const v339 = document.getElementById('division-popup');
document.getElementById('division-number-input').value = v17;
v339.classList.add('show');
}
function v340() {
const v339 = document.getElementById('division-popup');
v339.classList.remove('show');
}

function v341() {
const v342 = parseInt(document.getElementById('division-number-input').value);

if (v342 >= 2 && v342 <= 360) {
v343(v342);

v17 = v342;

v252();
v328();

v329();
v213 = v214();
v340();
} else {
alert('⚠️ Veuillez entrer un nombre entre 2 et 360.');
}
}

function v344(v345) {
v15 = v345;

const v346 = document.getElementById('clockwise-btn');
const v347 = document.getElementById('counterclockwise-btn');

if (v345 === 1) {
v346.classList.add('active');
v347.classList.remove('active');
} else {
v346.classList.remove('active');
v347.classList.add('active');
}
}

function v173() {
const v346 = document.getElementById('clockwise-btn');
const v347 = document.getElementById('counterclockwise-btn');

v346.addEventListener('click', () => {
v344(1);
});

v347.addEventListener('click', () => {
v344(-1);
});
}

function v348(v349, v350) {
const v351 = v350 / v349;
const v352 = Math.floor(v351);
const v353 = v351 - v352;

const v354 = {
v349: v349,
v350: v350,
v351: v351,
v352: v352,
v353: v353,
v355: (v353 === 0),
v356: null,
v357: []
};

if (!v354.v355) {
const v358 = (v359, v360) => v360 === 0 ? v359: v358(v360, v359 % v360);
const v361 = v349;
const v362 = Math.round(v353 * v349);
const v363 = v358(v362, v361);

v354.v356 = {
v364: v362 / v363,
v365: v361 / v363
};

const v366 = v354.v356.v365;
for (let v98 = 1; v98 * v366 < 100; v98++) {
const v367 = v98 * v366;
const v368 = v98 * v354.v356.v364;
v354.v357.push({
v367: v367,
v368: v368
});
}
}

return v354;
}

function v343(v349) {
const v354 = v348(v349, v16);

const v369 = document.getElementById('division-type-display');
if (v354.v355) {
v369.className = 'division-type direct';
v369.textContent = '✅ Division Directe (Simple)';
} else {
v369.className = 'division-type indirect';
v369.textContent = '🔍 Division Indirecte (Avec disque à trous)';
}

document.getElementById('info-divisions').textContent = v349;
document.getElementById('info-reduction').textContent = `1:${v16}`;

const v370 = document.getElementById('info-calculation');
if (v354.v355) {
v370.textContent = `${v16} ÷ ${v349} = ${v354.v351}`;
} else {
v370.innerHTML = `${v16} ÷ ${v349} = ${v354.v352} + <sup>${v354.v356.v364}</sup>⁄<sub>${v354.v356.v365}</sub>`;
}

const v371 = document.getElementById('info-turns');
if (v354.v355) {
v371.textContent = `(${v354.v351} tours )`;
} else {
v371.textContent = `(${v354.v352} tours + ${v354.v356.v364}/${v354.v356.v365} crans)`;
}

const v372 = document.getElementById('circles-section');
const v373 = document.getElementById('info-circles');

if (v354.v355) {
v372.style.display = 'none';
} else {
v372.style.display = 'block';
v373.innerHTML = '';

const v374 = document.createElement('div');
v374.className = 'current-disk-info';
v374.innerHTML = `
<strong>Disque actuel :</strong> ${v14} crans<br>
<small>Cliquez sur un disque ci-dessous pour changer automatiquement</small>
`;
v373.appendChild(v374);

const v375 = document.createElement('div');
v375.className = 'circles-list';

v354.v357.forEach((v376, v377) => {
const v378 = document.createElement('span');
v378.className = 'circle-item';

if (v376.v367 === v14) {
v378.classList.add('current');
v378.title = 'Disque actuellement utilisé';
} else {
v378.title = 'Cliquer pour utiliser ce disque';
}

v378.textContent = `${v376.v367} trous (${v376.v368} à sauter)`;

v378.addEventListener('click', () => {
v379(v376.v367, v378, v349);
});

v375.appendChild(v378);
});

v373.appendChild(v375);

const v380 = document.createElement('div');
v380.className = 'selection-hint';
v380.textContent = '💡 Cliquez sur un disque pour adapter automatiquement le nombre de crans de la manivelle';
v373.appendChild(v380);
}

document.getElementById('division-info-popup').classList.add('show');
}

function v381() {
document.getElementById('division-info-popup').classList.remove('show');
}

function v379(v382, v383, v349) {
const v321 = v7 ? v7.rotation.y: 0;

v14 = v382;

if (v7) {
v12 = Math.round(v321 * v16 * v14 / (Math.PI * 2));

const v322 = (v321 * 180 / Math.PI) % 360;
const v323 = 360 / v349;
const v324 = Math.round(v322 / v323);

const v325 = (v324 * v323 * Math.PI) / 180;
const v326 = Math.round(v325 * v16 * v14 / (Math.PI * 2));

v18 = v324;
v19 = v12 - v326;

v327();

v255();
v171();
v169();
v40();
}

const v384 = document.querySelectorAll('.circle-item');
v384.forEach(v385 => {
v385.classList.remove('selected', 'current');
});

v383.classList.add('selected');

const v374 = document.querySelector('.current-disk-info');
if (v374) {
v374.innerHTML = `
<strong>✅ Disque sélectionné :</strong> ${v382} crans<br>
<small>Manivelle adaptée automatiquement !</small>
`;
v374.style.background = '#e8f5e8';
v374.style.borderColor = '#4caf50';
}

setTimeout(() => {
const v380 = document.querySelector('.selection-hint');
if (v380) {
v380.textContent = `✅ Manivelle configurée avec ${v382} crans pour ${v349} divisions !`;
v380.style.background = '#e8f5e8';
v380.style.borderColor = '#4caf50';
v380.style.color = '#2e7d32';
}
},
100);
}

function v56(v382, v349) {
const v386 = (v382 * v16) / v349;
const v387 = Math.floor(v386);
const v388 = Math.round((v386 - v387) * v382);

return {
v387: v387,
v388: v388,
v382: v382
};
}

function v392() {
    const v393 = document.getElementById('reduction-display');
    if (v393) {
        v393.textContent = `1/${v16}`;
    }
}
function v390() {
    const v391 = document.createElement('div');
    v391.id = 'reduction-display';
    v391.style.cssText = `
        position: absolute;
        bottom: 3px;
        left: 3px;
        background: rgba(255, 87, 34, 0.9);
        color: white;
        padding: 2px 5px;
        border-radius: 6px;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 12px;
        font-weight: bold;
        z-index: 1000;
        pointer-events: none;
        border: 2px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    `;
    
    document.querySelector('.main-view').appendChild(v391);
    return v391;
}
function v394() {
    const v395 = document.createElement('div');
    v395.id = 'signature-display';
    v395.style.cssText = `
        position: absolute;
        bottom: 2px;
        right: 3px;
        background: rgba(128, 128, 128, 0.8);
        color: white;
        padding: 2px 5px;
        border-radius: 4px;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 12px;
        font-weight: bold;
        z-index: 1000;
        pointer-events: none;
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    `;
    
    v395.textContent = atob("NTlqYWc=");
    document.querySelector('.main-view').appendChild(v395);
    return v395;
}
window.addEventListener('click', function(v330) {
const v389 = document.getElementById('division-info-popup');
if (v330.target === v389) {
v381();
}
});

window.addEventListener('click', function(v330) {
const v339 = document.getElementById('division-popup');
if (v330.target === v339) {
v340();
}
});

window.addEventListener('resize', () => {
const v165 = document.getElementById('plateau-canvas');
v2.aspect = v165.clientWidth / v165.clientHeight;
v2.updateProjectionMatrix();
v3.setSize(v165.clientWidth, v165.clientHeight);
});

v164();
</script>
</body>
</html>
